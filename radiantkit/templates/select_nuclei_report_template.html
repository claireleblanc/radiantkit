<!DOCTYPE html>
<html>
<head>
	<title>RadIAnT-Kit - Nuclei selection</title>
	<script>{% include "include/jquery-3.4.1.min.js" %}</script>
	<script>{% include "include/popper.min.js" %}</script>
	<script>{% include "include/bootstrap.min.js" %}</script>
	<style>{% include "include/bootstrap.min.css" %}</style>
	<script>{% include "include/plotly-1.52.1.min.js" %}</script>
</head>
<body><div class="container">
	<h1 class="my-5">RadIAnT-Kit - Nuclei selection</h1>
	<div class="row">
		<div class="col">
			<nav>
				<div class="nav nav-tabs" id="nav-tab" role="tablist">
					<a class="nav-item nav-link active" id="nav-Settings-tab" data-toggle="tab" href="#nav-Settings" role="tab" aria-controls="nav-Settings" aria-selected="true">Settings</a>
					<a class="nav-item nav-link" id="nav-plot-tab" data-toggle="tab" href="#nav-plot" role="tab" aria-controls="nav-plot" aria-selected="false">Plot</a>
					<a class="nav-item nav-link" id="nav-data-tab" data-toggle="tab" href="#nav-data" role="tab" aria-controls="nav-data" aria-selected="false">Data</a>
				</div>
			</nav>
			<div class="tab-content p-3" id="nav-tabContent">
				<div class="tab-pane fade show active" id="nav-Settings" role="tabpanel" aria-labelledby="nav-Settings-tab">
					<table class="table table-hover table-bordered">
						<thead class="thead-dark">
							<tr>
								<th scope="col">Argument</th>
								<th scope="col">Value</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th scope="row">Input</th>
								<td>{{ args.input }}</td>
							</tr>
							<tr>
								<th scope="row">Reference channel</th>
								<td>{{ args.dna_channel }}</td>
							</tr>
							<tr>
								<th scope="row">Prefix</th>
								<td><code>{{ args.mask_prefix }}</code></td>
							</tr>
							<tr>
								<th scope="row">Suffix</th>
								<td><code>{{ args.mask_suffix }}</code></td>
							</tr>
							<tr>
								<th scope="row">K-sigma</th>
								<td>{{ args.k_sigma }}</td>
							</tr>
							<tr>
								<th scope="row">Compressed</th>
								<td>{{ args.compressed|string }}</td>
							</tr>
							<tr>
								<th scope="row">Rescale</th>
								<td>{{ args.do_rescaling|string }}</td>
							</tr>
							<tr>
								<th scope="row">Reg.exp.</th>
								<td><code>{{ args.inreg.pattern }}</code></td>
							</tr>
							<tr>
								<th scope="row">Threads</th>
								<td>{{ args.threads }}</td>
							</tr>
						</tbody>
					</table>
				</div>
				<div class="tab-pane fade" id="nav-plot" role="tabpanel" aria-labelledby="nav-plot-tab">
					<p>{{ data['pass'].sum() }} nuclei out of {{ data.shape[0] }} ({{ "%.2f"|format(data['pass'].sum()/data.shape[0]*100|float) }}%) pass the filter</p>
					<div id="select_nuclei" class="mx-auto" style="width: 1000px;"></div>
					<script>
						CONTAINER = document.getElementById('select_nuclei');
						PLOT_JSON = {{ plot_json|safe }};
						Plotly.newPlot( CONTAINER, PLOT_JSON.data, PLOT_JSON.layout, {"responsive":true})
					</script>
				</div>
				<div class="tab-pane fade" id="nav-data" role="tabpanel" aria-labelledby="nav-data-tab">
					<table class="table table-hover text-center">
						<thead class="thead-dark">
							<th scope="col">Directory</th>
							<th scope="col">Raw image</th>
							<th scope="col">Mask</th>
							<th scope="col"># Objects</th>
						</thead>
						<tbody>
							{% for series in series_list: %}
							<tr>
								<td>{{ series.channels[series.ref].path|dirname }}</td>
								<td>{{ series.channels[series.ref].path|basename }}</td>
								<td>{{ series.mask.path|basename }}</td>
								<td>{{ series.particles|length }}</td>
							</tr>
							{% endfor %}
							<tr>
								<th scope="row" colspan="3">Total</th>
								<td>{{ data.shape[0] }}</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<div class="row p-2">
		<p><small>Report generated on {{ now }}.</small></p>
	</div>
</div></body>
</html>
